<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Vue3+TypeScript补充与拓展 | 柚の小屋</title><meta name="keywords" content="TypeScript,Vue3.0,Pinia,vite"><meta name="author" content="柚子"><meta name="copyright" content="柚子"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Vue3+TypeScript+vite+Pinia知识补充与拓展">
<meta property="og:type" content="article">
<meta property="og:title" content="Vue3+TypeScript补充与拓展">
<meta property="og:url" content="https://youzi2233.github.io/undefined/63422.html">
<meta property="og:site_name" content="柚の小屋">
<meta property="og:description" content="Vue3+TypeScript+vite+Pinia知识补充与拓展">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://youzi2233.github.io/imgs/vue3-ts.jpg">
<meta property="article:published_time" content="2022-04-13T06:20:10.000Z">
<meta property="article:modified_time" content="2022-04-13T10:42:31.215Z">
<meta property="article:author" content="柚子">
<meta property="article:tag" content="TypeScript">
<meta property="article:tag" content="Vue3.0">
<meta property="article:tag" content="Pinia">
<meta property="article:tag" content="vite">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://youzi2233.github.io/imgs/vue3-ts.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://youzi2233.github.io/undefined/63422"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":350},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Vue3+TypeScript补充与拓展',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-04-13 18:42:31'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="//at.alicdn.com/t/font_3317499_ahdcdoun4i.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_3325029_luhqwmbab1c.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_3325054_x6pt85e68bf.css"><meta name="generator" content="Hexo 6.0.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="柚の小屋" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "/img/loading.gif" data-lazy-src="/img/avatar.jpg" onerror="onerror=null;src='/img/loading.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">13</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-a-fangzishouye"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw iconfont icon-a-aixinshoucang"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/imgs/vue3-ts.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">柚の小屋</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="iconfont icon-a-sousuoyulanchakanfangdajing"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-a-fangzishouye"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw iconfont icon-a-aixinshoucang"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Vue3+TypeScript补充与拓展</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-04-13T06:20:10.000Z" title="发表于 2022-04-13 14:20:10">2022-04-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-04-13T10:42:31.215Z" title="更新于 2022-04-13 18:42:31">2022-04-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Vue/">Vue</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>27分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Vue3+TypeScript补充与拓展"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="子父组件传参"><a href="#子父组件传参" class="headerlink" title="子父组件传参"></a>子父组件传参</h2><ul>
<li><p>父组件给子组件传参</p>
<ul>
<li><p>父组件通过v-bind绑定一个数据，然后子组件通过defineProps接收传过来的值</p>
 <figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">Cart</span> <span class="attr">:data</span>=<span class="string">"data"</span>  <span class="attr">title</span>=<span class="string">"我是标题"</span>&gt;</span><span class="tag">&lt;/<span class="name">Cart</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

 <figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">"ts"</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> <span class="title class_">Cart</span> <span class="keyword">from</span> <span class="string">'./components/Cart.vue'</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> { reactive } <span class="keyword">from</span> <span class="string">'vue'</span>;</span></span><br><span class="line"><span class="language-javascript"> </span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> data = reactive&lt;number[]&gt;([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>子组件接收值</p>
<ul>
<li><p>通过defineProps来接收</p>
</li>
<li><p>如果使用的是Ts，则可以使用传递字面量类型的纯类型语法作为参数</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"menu"</span>&gt;</span></span><br><span class="line">        菜单区域 {{ title }}</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>{{ data }}<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">"ts"</span>&gt;</span><span class="language-handlebars"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">type Props = {</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">    title:string;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">    data:number[];</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">defineProps<span class="tag">&lt;<span class="name">Props</span>&gt;</span>()</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"></span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>如果不是Ts</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">defineProps</span>({</span><br><span class="line">    <span class="attr">title</span>:{</span><br><span class="line">        <span class="attr">default</span>:<span class="string">""</span>,</span><br><span class="line">        <span class="attr">type</span>:string</span><br><span class="line">    },</span><br><span class="line">    <span class="attr">data</span>:<span class="title class_">Array</span></span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>withDefaults是个函数也是无须引入开箱即用接受一个props函数第二个参数是一个对象设置默认值</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Props</span> = {</span><br><span class="line">    title?: <span class="built_in">string</span>,</span><br><span class="line">    data?: <span class="built_in">number</span>[]</span><br><span class="line">}</span><br><span class="line"><span class="title function_">withDefaults</span>(defineProps&lt;<span class="title class_">Props</span>&gt;(), {</span><br><span class="line">    <span class="attr">title</span>: <span class="string">"张三"</span>,</span><br><span class="line">    <span class="attr">data</span>: <span class="function">() =&gt;</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
</li>
</ul>
</li>
<li><p>子组件给父组件传参</p>
<ul>
<li><p>通过defineEmits派发一个事件</p>
  <figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"clickTap"</span>&gt;</span>派发给父组件<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">"ts"</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> { reactive } <span class="keyword">from</span> <span class="string">'vue'</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> list = reactive&lt;number[]&gt;([<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>])</span></span><br><span class="line"><span class="language-javascript"> </span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> emit = <span class="title function_">defineEmits</span>([<span class="string">'on-click'</span>]) <span class="comment">//数组，可以定义多个</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">clickTap</span> = (<span class="params"></span>) =&gt; {</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">emit</span>(<span class="string">'on-click'</span>, list)</span></span><br><span class="line"><span class="language-javascript">}</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p>在子组件绑定了一个click事件，然后通过defineEmits注册了一个自定义事件，点击click触发emit去调用我们注册的事件，然后传递参数</p>
</li>
<li><p>父组件接收子组件的事件</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">Cart</span> @<span class="attr">on-click</span>=<span class="string">"getList"</span>&gt;</span><span class="tag">&lt;/<span class="name">Cart</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">"ts"</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> <span class="title class_">Cart</span> <span class="keyword">from</span> <span class="string">'./components/Cart.vue'</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> { reactive } <span class="keyword">from</span> <span class="string">'vue'</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">getList</span> = (<span class="params">list: number[]</span>) =&gt; {</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(list,<span class="string">'父组件接受子组件'</span>);</span></span><br><span class="line"><span class="language-javascript">}</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="双问号语法"><a href="#双问号语法" class="headerlink" title="双问号语法"></a>双问号语法</h2><blockquote>
<p>Js：在双问号的左边如果是<code>null，undefined</code>时，就返回右边的值，如果没有就返回左边的值</p>
</blockquote>
<ul>
<li><p>例如</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">null</span> ?? [] <span class="comment">//[]</span></span><br><span class="line"><span class="literal">undefined</span> ?? <span class="number">0</span> <span class="comment">//0</span></span><br><span class="line"></span><br><span class="line"><span class="number">0</span> ?? [] <span class="comment">//0</span></span><br><span class="line"><span class="literal">false</span> ?? <span class="number">0</span> <span class="comment">//false</span></span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<h2 id="TypeScript高级技巧（Pick，Partial等）"><a href="#TypeScript高级技巧（Pick，Partial等）" class="headerlink" title="TypeScript高级技巧（Pick，Partial等）"></a>TypeScript高级技巧（Pick，Partial等）</h2><h3 id="1-keyof和in"><a href="#1-keyof和in" class="headerlink" title="1. keyof和in"></a>1. keyof和in</h3><ul>
<li><p>keyof</p>
<blockquote>
<p>keyof与Object.keys略有相似，只不过keyof取interface的键</p>
</blockquote>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Point</span> {</span><br><span class="line">  <span class="attr">x</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">y</span>: <span class="built_in">number</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// type keys = "x" | "y"</span></span><br><span class="line"><span class="keyword">type</span> keys = keyof <span class="title class_">Point</span>;</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>in</p>
<blockquote>
<p>in可以遍历枚举类型，例如</p>
</blockquote>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Keys</span> = <span class="string">"a"</span> | <span class="string">"b"</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Obj</span> = {</span><br><span class="line">	[p <span class="keyword">in</span> <span class="title class_">Keys</span>]:<span class="built_in">any</span></span><br><span class="line">}</span><br><span class="line"><span class="comment">// -&gt; {a:any,b:any}</span></span><br></pre></td></tr></tbody></table></figure>

<blockquote>
<p>keyof产生枚举类型，in使用枚举类型遍历，所以他们经常一起使用，看下Partial源码</p>
</blockquote>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Partial</span>&lt;T&gt; = {[P <span class="keyword">in</span> keyof T]?:T[P]};</span><br></pre></td></tr></tbody></table></figure>

<blockquote>
<p>上面语句的意思是<code>keyof T</code>拿到<code>T</code>所有的属性名，然后<code>in</code>进行遍历，将值赋给P，最后<code>T[P]</code>取得相应属性的值</p>
</blockquote>
</li>
</ul>
<h3 id="Partial和Pick"><a href="#Partial和Pick" class="headerlink" title="Partial和Pick"></a>Partial和Pick</h3><figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Required</span>&lt;T&gt; = {</span><br><span class="line">  [P <span class="keyword">in</span> keyof T]-?: T[P];</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Partial</span>&lt;T&gt; = {</span><br><span class="line">  [P <span class="keyword">in</span> keyof T]?: T[P];</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Pick</span>&lt;T, K <span class="keyword">extends</span> keyof T&gt; = {</span><br><span class="line">  [P <span class="keyword">in</span> K]: T[P];</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">User</span> {</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="comment">// 相当于: type PartialUser = { id?: number; age?: number; name?: string; }</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PartialUser</span> = <span class="title class_">Partial</span>&lt;<span class="title class_">User</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 相当于: type PickUser = { id: number; age: number; }</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PickUser</span> = <span class="title class_">Pick</span>&lt;<span class="title class_">User</span>, <span class="string">"id"</span> | <span class="string">"age"</span>&gt;</span><br></pre></td></tr></tbody></table></figure>

<h2 id="动态组件"><a href="#动态组件" class="headerlink" title="动态组件"></a>动态组件</h2><blockquote>
<p>动态组件就是让多个组件使用同一个挂载点，并动态切换</p>
</blockquote>
<ul>
<li><p>使用：</p>
<ul>
<li><p>setup</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Cart</span> <span class="keyword">from</span> <span class="string">'./components/cart.vue'</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Card</span> <span class="keyword">from</span> <span class="string">'./components/card/index.vue'</span>;</span><br><span class="line"><span class="keyword">import</span> { reactive, markRaw } <span class="keyword">from</span> <span class="string">'vue'</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Tabs</span> = {</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">comName</span>: <span class="built_in">any</span>;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Com</span> = <span class="title class_">Pick</span>&lt;<span class="title class_">Tabs</span>, <span class="string">'comName'</span>&gt;</span><br><span class="line"><span class="comment">//相当于 type Com = {comeName: any}</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> data = reactive&lt;<span class="title class_">Tabs</span>[]&gt;([</span><br><span class="line">  {</span><br><span class="line">    <span class="attr">name</span>: <span class="string">'我是Cart组件'</span>,</span><br><span class="line">    <span class="attr">comName</span>: <span class="title function_">markRaw</span>(<span class="title class_">Cart</span>)</span><br><span class="line">  },</span><br><span class="line">  {</span><br><span class="line">    <span class="attr">name</span>: <span class="string">'我是Card组件'</span>,</span><br><span class="line">    <span class="attr">comName</span>: <span class="title function_">markRaw</span>(<span class="title class_">Card</span>)</span><br><span class="line">  }</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> current = reactive&lt;<span class="title class_">Com</span>&gt;({</span><br><span class="line">  <span class="attr">comName</span>: data[<span class="number">0</span>].<span class="property">comName</span> <span class="comment">//默认是第一个</span></span><br><span class="line">})</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">changeCom</span> = (<span class="params">item: Tabs</span>) =&gt; {</span><br><span class="line">  current.<span class="property">comName</span> = item.<span class="property">comName</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>template</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">   	@<span class="attr">click</span>=<span class="string">"changeCom(item)"</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">v-for</span>=<span class="string">"item in data"</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">:key</span>=<span class="string">"item.name"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">    {{ item.name }}</span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">component</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">:is</span>=<span class="string">"current.comName"</span> </span></span><br><span class="line"><span class="tag"> 	<span class="attr">title</span>=<span class="string">"这是标题"</span> </span></span><br><span class="line"><span class="tag"> 	<span class="attr">content</span>=<span class="string">"测试测试全局组件"</span></span></span><br><span class="line"><span class="tag"> &gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<blockquote>
<p>:is = “组件名”，也就是默认先展示的哪个组件，由button按钮的点击事件来切换显示的组件名</p>
</blockquote>
</li>
</ul>
</li>
<li><p>注意事项：</p>
<blockquote>
<ol>
<li>在Vue2的时候 is 是通过组件名称切换的，在Vue3 setup是通过组件实例切换的</li>
<li>如果把组件实例放到Reactive，Vue会给出警告，是因为reactive会进行proxy代理，而我们组件代理之后毫无用处，为节省性能开销推荐我们使用shallowRef或者markRaw跳过代理</li>
</ol>
</blockquote>
<p>markRaw实质就是添加了一个<code>__v_skip:true</code>属性，来跳过代理</p>
</li>
</ul>
<h2 id="Transition组件"><a href="#Transition组件" class="headerlink" title="Transition组件"></a>Transition组件</h2><h3 id="Transition生命周期"><a href="#Transition生命周期" class="headerlink" title="Transition生命周期"></a>Transition生命周期</h3><figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">before-enter</span>=<span class="string">"BeforeEnter"</span> //对应<span class="attr">enter-from</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">enter</span>=<span class="string">"EnterActive"</span>//对应<span class="attr">enter-active</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">after-enter</span>=<span class="string">"AfterEnter"</span>//对应<span class="attr">enter-to</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">enter-cancelled</span>=<span class="string">"EnterCancelled"</span>//显示过度打断</span></span><br><span class="line"><span class="tag">  @<span class="attr">before-leave</span>=<span class="string">"BeforeLeave"</span>//对应<span class="attr">leave-from</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">leave</span>=<span class="string">"LeaveActive"</span>//对应<span class="attr">enter-active</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">after-leave</span>=<span class="string">"AfterLeave"</span>//对应<span class="attr">leave-to</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">leave-cancelled</span>=<span class="string">"LeaveCancelled"</span>//离开过度打断</span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">"flag"</span> <span class="attr">class</span>=<span class="string">"box"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">"ts"</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> { ref } <span class="keyword">from</span> <span class="string">'vue'</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> flag = ref&lt;boolean&gt;(<span class="literal">true</span>)</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">BeforeEnter</span> = (<span class="params"></span>) =&gt; {</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">'进入之前'</span>);</span></span><br><span class="line"><span class="language-javascript">}</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">EnterActive</span> = (<span class="params">el: Element, done: <span class="built_in">Function</span></span>) =&gt; {</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">'过渡曲线'</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> {</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">done</span>();</span></span><br><span class="line"><span class="language-javascript">    }, <span class="number">2000</span>)</span></span><br><span class="line"><span class="language-javascript">}</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">AfterEnter</span> = (<span class="params"></span>) =&gt; {</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">'过渡完成'</span>);</span></span><br><span class="line"><span class="language-javascript">}</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">EnterCancelled</span> = (<span class="params"></span>) =&gt; {</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">'过渡效果被打断'</span>);</span></span><br><span class="line"><span class="language-javascript">}</span></span><br><span class="line"><span class="language-javascript"><span class="comment">//...</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<blockquote>
<p>当只用JavaScript过渡的时候，在enter和leave钩子中必须使用done进行回调</p>
</blockquote>
<p>结合gsap动画库使用<a target="_blank" rel="noopener" href="https://greensock.com/">GreenSock</a>(npm i gsap -S)</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gsap <span class="keyword">from</span> <span class="string">'gsap'</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">BeforeEnter</span> = (<span class="params">el: Element</span>) =&gt; {</span><br><span class="line">    gsap.<span class="title function_">set</span>(el, {</span><br><span class="line">        <span class="attr">width</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">height</span>: <span class="number">0</span>,</span><br><span class="line">    })</span><br><span class="line">}</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">EnterActive</span> = (<span class="params">el: Element, done: gsap.Callback</span>) =&gt; {</span><br><span class="line">    gsap.<span class="title function_">to</span>(el, {</span><br><span class="line">        <span class="attr">width</span>: <span class="number">200</span>,</span><br><span class="line">        <span class="attr">height</span>: <span class="number">200</span>,</span><br><span class="line">        <span class="attr">onComplete</span>: done</span><br><span class="line">    })</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="Transition-group过渡列表"><a href="#Transition-group过渡列表" class="headerlink" title="Transition-group过渡列表"></a>Transition-group过渡列表</h3><blockquote>
<p>如何同时渲染整个列表，这个场景下我们会使用<code>&lt;transition-group&gt;</code>组件</p>
</blockquote>
<p>特点：</p>
<ul>
<li>默认情况下，它不会渲染一个包裹元素，但你可以通过tag attribute指定渲染一个元素。</li>
<li>过渡模式不可用，因为我们不再相互切换特有的元素</li>
<li>内部元素总是需要提供唯一的key attribute值</li>
<li>CSS过渡的类将会应用在内部的元素中，而不是这个组/容器本身</li>
</ul>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"wraps"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">transition-group</span></span></span><br><span class="line"><span class="tag">	<span class="attr">enter-active-class</span>=<span class="string">"animate__animated animate__zoomIn"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">leave-active-class</span>=<span class="string">"animate__animated animate__rotateOutDownLeft"</span></span></span><br><span class="line"><span class="tag">	&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span> <span class="attr">v-for</span>=<span class="string">"item in list"</span> <span class="attr">:key</span>=<span class="string">"item"</span>&gt;</span>{{ item }}<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">transition-group</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"push"</span>&gt;</span>push<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"pop"</span>&gt;</span>pop<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">"ts"</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> { reactive } <span class="keyword">from</span> <span class="string">'vue'</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> <span class="string">'animate.css'</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> list = reactive&lt;number[]&gt;([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>])</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">push</span> = (<span class="params"></span>) =&gt; {</span></span><br><span class="line"><span class="language-javascript">    list.<span class="title function_">push</span>(list.<span class="property">length</span> + <span class="number">1</span>)</span></span><br><span class="line"><span class="language-javascript">}</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">pop</span> = (<span class="params"></span>) =&gt; {</span></span><br><span class="line"><span class="language-javascript">    list.<span class="title function_">pop</span>()</span></span><br><span class="line"><span class="language-javascript">}</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p>列表的移动过渡</p>
<blockquote>
<p><code>&lt;transition-group&gt;</code>组件还有一个特殊之处。除了进入和离开，它还可以为定位的改变添加动画。只需了解新增的v-move类就可以使用这个新功能，它会应用在元素改变定位过程中。像之前的类名一样，它的前缀可以通过name attribute来自定义，也可以通过move-class attribute手动设置</p>
</blockquote>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"random"</span>&gt;</span>random<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">transition-group</span> <span class="attr">move-class</span>=<span class="string">"move"</span> <span class="attr">tag</span>=<span class="string">"ul"</span> <span class="attr">class</span>=<span class="string">"wraps"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item"</span> <span class="attr">v-for</span>=<span class="string">"item in list"</span> <span class="attr">:key</span>=<span class="string">"item.id"</span>&gt;</span>{{ item.number }}<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">transition-group</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">"ts"</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> { ref } <span class="keyword">from</span> <span class="string">'vue'</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">//npm i lodash,npm i @types/lodash -D</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> _ <span class="keyword">from</span> <span class="string">'lodash'</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">let</span> list = <span class="title function_">ref</span>(<span class="title class_">Array</span>.<span class="title function_">apply</span>(<span class="literal">null</span>, { <span class="attr">length</span>: <span class="number">81</span> } <span class="keyword">as</span> number[]).<span class="title function_">map</span>(<span class="function">(<span class="params">_, index</span>) =&gt;</span> {</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> {</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">id</span>: index,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">number</span>: (index % <span class="number">9</span>) + <span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">    }</span></span><br><span class="line"><span class="language-javascript">}))</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">console</span>.<span class="title function_">log</span>(list.<span class="property">value</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">random</span> = (<span class="params"></span>) =&gt; {</span></span><br><span class="line"><span class="language-javascript">    list.<span class="property">value</span> = _.<span class="title function_">shuffle</span>(list.<span class="property">value</span>)</span></span><br><span class="line"><span class="language-javascript">}</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">"less"</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.wraps</span> {</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">flex-wrap</span>: wrap;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="built_in">calc</span>(<span class="number">27px</span> * <span class="number">9</span>);</span></span><br><span class="line"><span class="language-css">}</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.item</span> {</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">25px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">25px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">}</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.move</span> {</span></span><br><span class="line"><span class="language-css">    <span class="attribute">transition</span>: all <span class="number">1s</span>;</span></span><br><span class="line"><span class="language-css">}</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<h2 id="自动引入插件"><a href="#自动引入插件" class="headerlink" title="自动引入插件"></a>自动引入插件</h2><blockquote>
<p>npm i -D unplugin-auto-import</p>
</blockquote>
<p>vite.config.ts配置</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { defineConfig } <span class="keyword">from</span> <span class="string">'vite'</span></span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">'@vitejs/plugin-vue'</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AutoImport</span> <span class="keyword">from</span> <span class="string">'unplugin-auto-import/vite'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// https://vitejs.dev/config/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>({</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="title function_">vue</span>(), <span class="title class_">AutoImport</span>({</span><br><span class="line">    <span class="attr">imports</span>: [<span class="string">'vue'</span>],</span><br><span class="line">    <span class="attr">dts</span>: <span class="string">"src/auto-import.d.ts"</span>,</span><br><span class="line">  })]</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>

<h2 id="TSX"><a href="#TSX" class="headerlink" title="TSX"></a>TSX</h2><blockquote>
<p>我们之前使用template去写模板，现在可以拓展另一种风格：TSX风格</p>
<p>vue2 的时候就已经支持jsx写法，只不过不是很友好，随着vue3对TypeScript的支持度，tsx写法越来越被接受</p>
</blockquote>
<ol>
<li><p>安装插件</p>
<ul>
<li><p>npm i @vitejs/plugin-vue-jsx -D</p>
</li>
<li><p>vite.config.ts配置</p>
  <figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { defineConfig } <span class="keyword">from</span> <span class="string">'vite'</span></span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">'@vitejs/plugin-vue'</span></span><br><span class="line"><span class="keyword">import</span> vueJsx <span class="keyword">from</span> <span class="string">'@vitejs/plugin-vue-jsx'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// https://vitejs.dev/config/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>({</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="title function_">vue</span>(), <span class="title function_">vueJsx</span>()]</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
</li>
<li><p>修改tsconfig.json配置文件</p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line">  <span class="attr">"compilerOptions"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">      ...</span><br><span class="line">	<span class="attr">"jsx"</span><span class="punctuation">:</span> <span class="string">"preserve"</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"jsxFactory"</span><span class="punctuation">:</span> <span class="string">"h"</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"jsxFragmentFactory"</span><span class="punctuation">:</span> <span class="string">"Fragment"</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    ...</span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure>

<p>配置完成就可以使用了，在目录新建一个xxx.tsx文件</p>
</li>
<li><p>使用TSX</p>
<blockquote>
<p>tip:tsx不会自动解包，使用ref加.value</p>
<p>xx.vue组件使用：</p>
<p><code>import renderDom from './tsx/show';</code>不用加后缀</p>
<p><code> &lt;renderDom&gt;&lt;/renderDom&gt;</code></p>
</blockquote>
<ul>
<li><p>TSX支持v-model的使用</p>
<figure class="highlight tsx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">import</span> { ref } <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">let</span> v = ref&lt;<span class="built_in">string</span>&gt;(<span class="string">''</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="title function_">renderDom</span> = (<span class="params"></span>) =&gt; {</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">           <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">{v.value}</span> <span class="attr">type</span>=<span class="string">"text"</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">           <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">               {v.value}</span></span><br><span class="line"><span class="language-xml">           <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> renderDom</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>v-show</p>
<figure class="highlight tsx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { ref } <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> flag = <span class="title function_">ref</span>(<span class="literal">false</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">changeFlag</span> = (<span class="params"></span>) =&gt; {</span><br><span class="line">    flag.<span class="property">value</span> = !flag.<span class="property">value</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">renderDom</span> = (<span class="params"></span>) =&gt; {</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">{changeFlag}</span>&gt;</span>changeFlag<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-show</span>=<span class="string">{flag.value}</span>&gt;</span>小明<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-show</span>=<span class="string">{!flag.value}</span>&gt;</span>小天<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> renderDom</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>v-if是不支持的，需要改变风格</p>
<figure class="highlight tsx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { ref } <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">let</span> flag = <span class="title function_">ref</span>(<span class="literal">false</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="title function_">renderDom</span> = (<span class="params"></span>) =&gt; {</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            {</span></span><br><span class="line"><span class="language-xml">                flag.value ? <span class="tag">&lt;<span class="name">div</span>&gt;</span>小明<span class="tag">&lt;/<span class="name">div</span>&gt;</span> : <span class="tag">&lt;<span class="name">div</span>&gt;</span>小天<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            }</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> renderDom</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>v-for也是不支持的，需要使用Map</p>
<figure class="highlight tsx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { ref } <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="title function_">renderDom</span> = (<span class="params"></span>) =&gt; {</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            {</span></span><br><span class="line"><span class="language-xml">              arr.map(v=&gt;{</span></span><br><span class="line"><span class="language-xml">                  return <span class="tag">&lt;<span class="name">div</span>&gt;</span>{v}<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              })</span></span><br><span class="line"><span class="language-xml">            }</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> renderDom</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>v-bind，直接赋值就行</p>
<figure class="highlight tsx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { ref } <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="title function_">renderDom</span> = (<span class="params"></span>) =&gt; {</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">data-arr</span>=<span class="string">{arr}</span>&gt;</span>1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> renderDom</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>v-on绑定事件，所有的事件都按照react风格来</p>
<ul>
<li><p>所有事件有on开头</p>
</li>
<li><p>所有事件名称首字母大写</p>
<figure class="highlight tsx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { ref } <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> flag = <span class="title function_">ref</span>(<span class="literal">false</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">changeFlag</span> = (<span class="params"></span>) =&gt; {</span><br><span class="line">    flag.<span class="property">value</span> = !flag.<span class="property">value</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">renderDom</span> = (<span class="params"></span>) =&gt; {</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">{changeFlag}</span>&gt;</span>changeFlag<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-show</span>=<span class="string">{flag.value}</span>&gt;</span>小明<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-show</span>=<span class="string">{!flag.value}</span>&gt;</span>小天<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> renderDom</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
</li>
<li><p>Props接收值</p>
<figure class="highlight tsx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { ref } <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Props</span> = {</span><br><span class="line">    <span class="attr">title</span>:<span class="built_in">string</span></span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="title function_">renderDom</span> = (<span class="params">props:Props</span>) =&gt; {</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span>&gt;</span>{props.title}<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">{clickTap}</span>&gt;</span>点击<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="title function_">clickTap</span> = (<span class="params"></span>) =&gt; {</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">'click'</span>);</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> renderDom</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>Emit派发</p>
<figure class="highlight tsx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Props</span> = {</span><br><span class="line">    <span class="attr">title</span>: <span class="built_in">string</span></span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="title function_">renderDom</span> = (<span class="params">props: Props,content:<span class="built_in">any</span></span>) =&gt; {</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span>&gt;</span>{props.title}<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">{clickTap.bind(this,content)}</span>&gt;</span>点击<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="title function_">clickTap</span> = (<span class="params">ctx:<span class="built_in">any</span></span>) =&gt; {</span><br><span class="line"> </span><br><span class="line">    ctx.<span class="title function_">emit</span>(<span class="string">'on-click'</span>,<span class="number">1</span>)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
</li>
</ol>
<h2 id="Pinia"><a href="#Pinia" class="headerlink" title="Pinia"></a>Pinia</h2><img src= "/img/loading.gif" data-lazy-src="https://pinia.vuejs.org/logo.svg" style="width:200px;height:200px">

<blockquote>
<p>全局状态管理工具</p>
<p>Pinia.js有如下特点：</p>
<ul>
<li>完整的TS的支持</li>
<li>足够轻量，压缩后的体积只有1kb左右</li>
<li>去除mutations，只有state，getters，actions；</li>
<li>actions支持同步和异步</li>
<li>代码扁平化没有模块嵌套，只有store的概念，store之间可以自由使用，每一个store都是独立的</li>
<li>无序手动添加store，store一旦创建会自动添加</li>
<li>支持Vue3和Vue2</li>
</ul>
</blockquote>
<ul>
<li><p>安装</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i pinia</span><br><span class="line">yarn add pinia</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>引入注册Vue3</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { createApp } <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">'./App.vue'</span></span><br><span class="line"><span class="keyword">import</span> {createPinia} <span class="keyword">from</span> <span class="string">'pinia'</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createPinia</span>()</span><br><span class="line"><span class="keyword">let</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line"> </span><br><span class="line">app.<span class="title function_">use</span>(store)</span><br><span class="line"> </span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">'#app'</span>)</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<h3 id="初始化仓库Store"><a href="#初始化仓库Store" class="headerlink" title="初始化仓库Store"></a>初始化仓库Store</h3><ul>
<li><p>在根目录新建一个store文件夹并新建一个index.ts</p>
</li>
<li><p>定义仓库</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { defineStore } <span class="keyword">from</span> <span class="string">"pinia"</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">enum</span> <span class="title class_">Names</span> {</span><br><span class="line">    <span class="variable constant_">TEST</span> = <span class="string">'TEST'</span>,</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useTestStore = <span class="title function_">defineStore</span>(<span class="title class_">Names</span>.<span class="property">TEST</span>, {</span><br><span class="line">    <span class="attr">state</span>: <span class="function">() =&gt;</span> {</span><br><span class="line">        <span class="keyword">return</span> {</span><br><span class="line">            <span class="attr">current</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">name</span>: <span class="string">"小明"</span>,</span><br><span class="line">        }</span><br><span class="line">    },</span><br><span class="line">    <span class="comment">//类似于computed可以帮助我们去修饰值</span></span><br><span class="line">    <span class="attr">getters</span>: {</span><br><span class="line"></span><br><span class="line">    },</span><br><span class="line">    <span class="comment">//可以操作异步 和 同步提交state</span></span><br><span class="line">    <span class="attr">actions</span>: {</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>组件使用</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"Test.current++"</span>&gt;</span>add<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        pinia: {{ Test.current }}--{{ Test.name }}</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">"ts"</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> { useTestStore } <span class="keyword">from</span> <span class="string">'../store'</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title class_">Test</span> = <span class="title function_">useTestStore</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Test</span>); <span class="comment">//Proxy</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<h3 id="State的修改"><a href="#State的修改" class="headerlink" title="State的修改"></a>State的修改</h3><ul>
<li><p>直接修改</p>
</li>
<li><p>批量修改State的值</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"change"</span>&gt;</span>change<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        pinia: {{ Test.current }}--{{ Test.name }}</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">"ts"</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> { useTestStore } <span class="keyword">from</span> <span class="string">'../store'</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title class_">Test</span> = <span class="title function_">useTestStore</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">change</span> = (<span class="params"></span>) =&gt; {</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Test</span>.$patch({</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">current</span>: <span class="number">200</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">name</span>: <span class="string">'pinia'</span></span></span><br><span class="line"><span class="language-javascript">    })</span></span><br><span class="line"><span class="language-javascript">}</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>批量修改（函数形式）</p>
<blockquote>
<p>推荐，可以自定义修改逻辑</p>
</blockquote>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"change"</span>&gt;</span>change<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        pinia: {{ Test.current }}--{{ Test.name }}</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">"ts"</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> { useTestStore } <span class="keyword">from</span> <span class="string">'../store'</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title class_">Test</span> = <span class="title function_">useTestStore</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">change</span> = (<span class="params"></span>) =&gt; {</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Test</span>.$patch(<span class="function">(<span class="params">state</span>) =&gt;</span> {</span></span><br><span class="line"><span class="language-javascript">        state.<span class="property">current</span> = <span class="number">200</span>;</span></span><br><span class="line"><span class="language-javascript">        state.<span class="property">name</span> = <span class="string">'pinia'</span>;</span></span><br><span class="line"><span class="language-javascript">    })</span></span><br><span class="line"><span class="language-javascript">}</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>通过原始对象修改整个实例</p>
<blockquote>
<p>$state可以通过将store的属性设置为新对象来替换store的整个状态，缺点就是必须修改整个对象的所有属性</p>
</blockquote>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"change"</span>&gt;</span>change<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        pinia: {{ Test.current }}--{{ Test.name }}</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">"ts"</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> { useTestStore } <span class="keyword">from</span> <span class="string">'../store'</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title class_">Test</span> = <span class="title function_">useTestStore</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">change</span> = (<span class="params"></span>) =&gt; {</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Test</span>.<span class="property">$state</span> = {</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">current</span>: <span class="number">200</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">name</span>: <span class="string">'pinia'</span></span></span><br><span class="line"><span class="language-javascript">    }</span></span><br><span class="line"><span class="language-javascript">}</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>通过actions修改</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { defineStore } <span class="keyword">from</span> <span class="string">"pinia"</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">enum</span> <span class="title class_">Names</span> {</span><br><span class="line">    <span class="variable constant_">TEST</span> = <span class="string">'TEST'</span>,</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useTestStore = <span class="title function_">defineStore</span>(<span class="title class_">Names</span>.<span class="property">TEST</span>, {</span><br><span class="line">    <span class="attr">state</span>: <span class="function">() =&gt;</span> {</span><br><span class="line">        <span class="keyword">return</span> {</span><br><span class="line">            <span class="attr">current</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">name</span>: <span class="string">"小明"</span>,</span><br><span class="line">        }</span><br><span class="line">    },</span><br><span class="line">    <span class="attr">getters</span>: {</span><br><span class="line"></span><br><span class="line">    },</span><br><span class="line">    <span class="attr">actions</span>: {</span><br><span class="line">        <span class="title function_">setCurrent</span>(<span class="params">num:<span class="built_in">number</span></span>) {</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">current</span> = num</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">change</span> = (<span class="params"></span>) =&gt; {</span><br><span class="line">    <span class="title class_">Test</span>.<span class="title function_">setCurrent</span>(<span class="number">999</span>)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<h3 id="解构Store"><a href="#解构Store" class="headerlink" title="解构Store"></a>解构Store</h3><blockquote>
<p>在Pinia是不允许直接解构，会失去响应式</p>
<p>需要导入storeToRefs包裹起来</p>
</blockquote>
  <figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"change"</span>&gt;</span>change<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        pinia: {{ current }}--{{ name }}</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">"ts"</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> { useTestStore } <span class="keyword">from</span> <span class="string">'../store'</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> { storeToRefs } <span class="keyword">from</span> <span class="string">'pinia'</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title class_">Test</span> = <span class="title function_">useTestStore</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> { current, name } = <span class="title function_">storeToRefs</span>(<span class="title class_">Test</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">change</span> = (<span class="params"></span>) =&gt; {</span></span><br><span class="line"><span class="language-javascript">    current.<span class="property">value</span>++</span></span><br><span class="line"><span class="language-javascript">}</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="actions，getters"><a href="#actions，getters" class="headerlink" title="actions，getters"></a>actions，getters</h3><ul>
<li><p>actions（支持同步异步）</p>
<ol>
<li>直接调用即可</li>
</ol>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { defineStore } <span class="keyword">from</span> <span class="string">"pinia"</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">enum</span> <span class="title class_">Names</span> {</span><br><span class="line">    <span class="variable constant_">TEST</span> = <span class="string">'TEST'</span>,</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useTestStore = <span class="title function_">defineStore</span>(<span class="title class_">Names</span>.<span class="property">TEST</span>, {</span><br><span class="line">    <span class="attr">state</span>: <span class="function">() =&gt;</span> {</span><br><span class="line">        <span class="keyword">return</span> {</span><br><span class="line">            <span class="attr">current</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">name</span>: <span class="string">"小明"</span>,</span><br><span class="line">        }</span><br><span class="line">    },</span><br><span class="line">    <span class="attr">getters</span>: {</span><br><span class="line"></span><br><span class="line">    },</span><br><span class="line">    <span class="attr">actions</span>: {</span><br><span class="line">        <span class="title function_">setCurrent</span>(<span class="params">num:<span class="built_in">number</span></span>) {</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">current</span> = num</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">change</span> = (<span class="params"></span>) =&gt; {</span><br><span class="line">    <span class="title class_">Test</span>.<span class="title function_">setCurrent</span>(<span class="number">999</span>)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<ol start="2">
<li>异步，可以结合async await修饰</li>
</ol>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { defineStore } <span class="keyword">from</span> <span class="string">"pinia"</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">enum</span> <span class="title class_">Names</span> {</span><br><span class="line">    <span class="variable constant_">TEST</span> = <span class="string">'TEST'</span>,</span><br><span class="line">}</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Result</span> = {</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">    <span class="attr">current</span>: <span class="built_in">number</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">User</span> = (): <span class="title class_">Promise</span>&lt;<span class="title class_">Result</span>&gt; =&gt; {</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> {</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> {</span><br><span class="line">            <span class="title function_">resolve</span>({</span><br><span class="line">                <span class="attr">name</span>: <span class="string">'小柚'</span>,</span><br><span class="line">                <span class="attr">current</span>: <span class="number">18</span></span><br><span class="line">            })</span><br><span class="line">        }, <span class="number">3000</span>)</span><br><span class="line">    })</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useTestStore = <span class="title function_">defineStore</span>(<span class="title class_">Names</span>.<span class="property">TEST</span>, {</span><br><span class="line">    <span class="attr">state</span>: <span class="function">() =&gt;</span> {</span><br><span class="line">        <span class="keyword">return</span> {</span><br><span class="line">            <span class="attr">name</span>: <span class="string">"小明"</span>,</span><br><span class="line">            <span class="attr">current</span>: <span class="number">1</span>,</span><br><span class="line">        }</span><br><span class="line">    },</span><br><span class="line">    <span class="attr">getters</span>: {</span><br><span class="line"></span><br><span class="line">    },</span><br><span class="line">    <span class="attr">actions</span>: {</span><br><span class="line">        <span class="keyword">async</span> <span class="title function_">setCurrent</span>(<span class="params"></span>) {</span><br><span class="line">            <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title class_">User</span>()</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">name</span> = result.<span class="property">name</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">current</span> = result.<span class="property">current</span></span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>

<ol start="3">
<li>多个action互相调用</li>
</ol>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">actions</span>: {</span><br><span class="line">        <span class="keyword">async</span> <span class="title function_">setCurrent</span>(<span class="params"></span>) {</span><br><span class="line">            <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title class_">User</span>()</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">name</span> = result.<span class="property">name</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">current</span> = result.<span class="property">current</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">changeAge</span>() <span class="comment">//相互调用</span></span><br><span class="line">        },</span><br><span class="line">        <span class="title function_">changeAge</span>(<span class="params"></span>) {</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">age</span> = <span class="number">20</span></span><br><span class="line">        }</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>getters</p>
<blockquote>
<p>主要作用类似于computed数据修饰并且有缓存</p>
</blockquote>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">getters</span>: {</span><br><span class="line">    <span class="title function_">newName</span>(): <span class="built_in">string</span> {</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`$-<span class="subst">${<span class="variable language_">this</span>.name}</span>`</span></span><br><span class="line">    }</span><br><span class="line">},</span><br></pre></td></tr></tbody></table></figure>

<p>然后在模板中直接使用</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        getters:{{ Test.newName }}</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<h3 id="API"><a href="#API" class="headerlink" title="API"></a>API</h3><ol>
<li><p>$reset</p>
<blockquote>
<p>重置store到他的初始状态</p>
</blockquote>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">reset</span> = (<span class="params"></span>) =&gt; {</span><br><span class="line">    <span class="title class_">Test</span>.$reset()</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>初始状态的数据是：</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">state</span>: <span class="function">() =&gt;</span> {</span><br><span class="line">       <span class="keyword">return</span> {</span><br><span class="line">           <span class="attr">name</span>: <span class="string">"小明"</span>,</span><br><span class="line">           <span class="attr">current</span>: <span class="number">1</span>,</span><br><span class="line">           <span class="attr">age</span>: <span class="number">18</span></span><br><span class="line">       }</span><br><span class="line">   },</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>订阅state的改变</p>
<blockquote>
<p>类似于Vuex的abscribe，只要有state的变化就会走这个函数</p>
</blockquote>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Test</span>.$subscribe(<span class="function">(<span class="params">args,state</span>)=&gt;</span>{</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(args,state);</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>

<p>第二个参数：如果你的组件卸载之后还想继续调用请设置第二个参数</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Test</span>.$subscribe(<span class="function">(<span class="params">args,state</span>)=&gt;</span>{</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(args,state); </span><br><span class="line">},{</span><br><span class="line">  <span class="attr">detached</span>:<span class="literal">true</span></span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>订阅actions的调用</p>
<blockquote>
<p>只要actions被调用就会走这个函数</p>
</blockquote>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Test</span>.$onAction(<span class="function">(<span class="params">args</span>)=&gt;</span>{</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(args);</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure></li>
</ol>
<h3 id="pinia持久化插件"><a href="#pinia持久化插件" class="headerlink" title="pinia持久化插件"></a>pinia持久化插件</h3><blockquote>
<p>页面每次刷新都会丢失状态</p>
<p>需要写一个pinia插件去缓存值到localStorage </p>
</blockquote>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { createApp, toRaw } <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Card</span> <span class="keyword">from</span> <span class="string">'./components/card/index.vue'</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">'./App.vue'</span></span><br><span class="line"><span class="keyword">import</span> { createPinia, <span class="title class_">PiniaPluginContext</span> } <span class="keyword">from</span> <span class="string">'pinia'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> __piniaKey__ = <span class="string">'__piniaKey__'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">setStorage</span> = (<span class="params">key: <span class="built_in">string</span>, value: <span class="built_in">any</span></span>) =&gt; {</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(value))</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getStorage</span> = (<span class="params">key: <span class="built_in">string</span></span>) =&gt; {</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key) ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key) <span class="keyword">as</span> <span class="built_in">string</span>) : {}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">//首先定义持久化插件，接收用户传的参数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">piniaPlugin</span> = (<span class="params">context: PiniaPluginContext</span>) =&gt; {</span><br><span class="line"></span><br><span class="line">    <span class="comment">//利用这个PiniaPluginContext来解构出store</span></span><br><span class="line">    <span class="keyword">const</span> { store } = context;</span><br><span class="line">    <span class="comment">//从localStorage中获取存储的数据</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//这里如果你的仓库有2个以上，那么data就会有两份以上，所以都会持久化的</span></span><br><span class="line">    <span class="keyword">const</span> data = <span class="title function_">getStorage</span>(<span class="string">`<span class="subst">${__piniaKey__}</span>-<span class="subst">${store.$id}</span>`</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//监听store的变化,并且把变化的值存到localStorage中</span></span><br><span class="line">    store.$subscribe(<span class="function">() =&gt;</span> {</span><br><span class="line">        <span class="comment">//将这个store存到localStorage中，但这是proxy对象，需要转换成普通对象</span></span><br><span class="line">        <span class="title function_">setStorage</span>(<span class="string">`<span class="subst">${__piniaKey__}</span>-<span class="subst">${store.$id}</span>`</span>, <span class="title function_">toRaw</span>(store.<span class="property">$state</span>))</span><br><span class="line">    })</span><br><span class="line">    <span class="comment">//返还接收到的这个对象</span></span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createPinia</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">//那么这里就可以使用接收到的data了</span></span><br><span class="line">store.<span class="title function_">use</span>(piniaPlugin)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">component</span>(<span class="string">'Card'</span>, <span class="title class_">Card</span>)</span><br><span class="line">app.<span class="title function_">use</span>(store)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">'#app'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>如果需要接收用户传的参数，可以这样</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { createApp, toRaw } <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Card</span> <span class="keyword">from</span> <span class="string">'./components/card/index.vue'</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">'./App.vue'</span></span><br><span class="line"><span class="keyword">import</span> { createPinia, <span class="title class_">PiniaPluginContext</span> } <span class="keyword">from</span> <span class="string">'pinia'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Optioins</span> = {</span><br><span class="line">    key?: <span class="built_in">string</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> __piniaKey__ = <span class="string">'__piniaKey__'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">setStorage</span> = (<span class="params">key: <span class="built_in">string</span>, value: <span class="built_in">any</span></span>) =&gt; {</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(value))</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getStorage</span> = (<span class="params">key: <span class="built_in">string</span></span>) =&gt; {</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key) ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key) <span class="keyword">as</span> <span class="built_in">string</span>) : {}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">//首先定义持久化插件，接收用户传的参数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">piniaPlugin</span> = (<span class="params">options: Optioins</span>) =&gt; {</span><br><span class="line"></span><br><span class="line">    <span class="comment">//利用这个PiniaPluginContext来解构出store</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">context: PiniaPluginContext</span>) =&gt;</span> {</span><br><span class="line">        <span class="keyword">const</span> { store } = context;</span><br><span class="line">        <span class="comment">//从localStorage中获取存储的数据</span></span><br><span class="line">        <span class="keyword">const</span> data = <span class="title function_">getStorage</span>(<span class="string">`<span class="subst">${options?.key ?? __piniaKey__}</span>-<span class="subst">${store.$id}</span>`</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment">//监听store的变化,并且把变化的值存到localStorage中</span></span><br><span class="line">        store.$subscribe(<span class="function">() =&gt;</span> {</span><br><span class="line">            <span class="comment">//将这个store存到localStorage中，但这是proxy对象，需要转换成普通对象</span></span><br><span class="line">            <span class="title function_">setStorage</span>(<span class="string">`<span class="subst">${options?.key ?? __piniaKey__}</span>-<span class="subst">${store.$id}</span>`</span>, <span class="title function_">toRaw</span>(store.<span class="property">$state</span>))</span><br><span class="line">        })</span><br><span class="line">        <span class="comment">//返还接收到的这个对象</span></span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createPinia</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">//那么这里就可以使用接收到的data了</span></span><br><span class="line">store.<span class="title function_">use</span>(<span class="title function_">piniaPlugin</span>({}))</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">component</span>(<span class="string">'Card'</span>, <span class="title class_">Card</span>)</span><br><span class="line">app.<span class="title function_">use</span>(store)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">'#app'</span>)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="Vue-Router4"><a href="#Vue-Router4" class="headerlink" title="Vue-Router4"></a>Vue-Router4</h2><h3 id="入门"><a href="#入门" class="headerlink" title="入门"></a>入门</h3><ul>
<li><p>安装：</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i vue-router@<span class="number">4</span>   <span class="comment">//vue3，vue2需要用3版本</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>初始化</p>
<blockquote>
<p>在src目录下新建一个router文件夹，并新建index.ts</p>
</blockquote>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//引入路由对象</span></span><br><span class="line"><span class="keyword">import</span> { createRouter, createWebHistory, createWebHashHistory, createMemoryHistory, <span class="title class_">RouteRecordRaw</span> } <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//vue2是 mode: history | vue3是 history:createWebHistory</span></span><br><span class="line"><span class="comment">//vue2是 mode: hash    | vue3是 history:createWebHashHistory</span></span><br><span class="line"><span class="comment">//vue2是 mode: abstact | vue3是 history:createMemoryHistory</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//路由数组的类型 RouteRecordRaw</span></span><br><span class="line"><span class="comment">// 定义一些路由</span></span><br><span class="line"><span class="comment">// 每个路由都需要映射到一个组件。</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">routes</span>: <span class="title class_">Array</span>&lt;<span class="title class_">RouteRecordRaw</span>&gt; = [</span><br><span class="line">    {</span><br><span class="line">        <span class="comment">//默认</span></span><br><span class="line">        <span class="attr">path</span>: <span class="string">"/"</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">'../components/Pinia.vue'</span>)</span><br><span class="line">    },</span><br><span class="line">    {</span><br><span class="line">        <span class="attr">path</span>: <span class="string">"/cart"</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">'../components/cart.vue'</span>)</span><br><span class="line">    }</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>({</span><br><span class="line">    <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(),</span><br><span class="line">    routes</span><br><span class="line">})</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="comment">//导出router</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>在main.ts挂载</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { createApp } <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">'./App.vue'</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">'./router'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(router)</span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">'#app'</span>)</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>在组件中使用</p>
<blockquote>
<p>这里与vue2用法一致</p>
</blockquote>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Router<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/"</span>&gt;</span>Pinia<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/cart"</span>&gt;</span>Cart<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">"ts"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">a</span> {</span></span><br><span class="line"><span class="language-css">  <span class="attribute">text-decoration</span>: none;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin-right</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">}</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<h3 id="编程式导航"><a href="#编程式导航" class="headerlink" title="编程式导航"></a>编程式导航</h3><ul>
<li><p>字符串模式</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Router<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- &lt;router-link to="/"&gt;Pinia&lt;/router-link&gt;</span></span><br><span class="line"><span class="comment">  &lt;router-link to="/cart"&gt;Cart&lt;/router-link&gt; --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"toPage('/')"</span>&gt;</span>Pinia<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"toPage('/cart')"</span> <span class="attr">style</span>=<span class="string">"margin-left: 10px;"</span>&gt;</span>Cart<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">"ts"</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">//使用官方的hock</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> { useRouter } <span class="keyword">from</span> <span class="string">'vue-router'</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">toPage</span> = (<span class="params">url: string</span>) =&gt; {</span></span><br><span class="line"><span class="language-javascript">  router.<span class="title function_">push</span>(url)</span></span><br><span class="line"><span class="language-javascript">}</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>对象模式</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用官方的hock</span></span><br><span class="line"><span class="keyword">import</span> { useRouter } <span class="keyword">from</span> <span class="string">'vue-router'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">toPage</span> = (<span class="params">url: <span class="built_in">string</span></span>) =&gt; {</span><br><span class="line">  router.<span class="title function_">push</span>({</span><br><span class="line">    <span class="attr">path</span>: url</span><br><span class="line">  })</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>命名式路由模式</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用官方的hock</span></span><br><span class="line"><span class="keyword">import</span> { useRouter } <span class="keyword">from</span> <span class="string">'vue-router'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">toPage</span> = (<span class="params"></span>) =&gt; {</span><br><span class="line">  router.<span class="title function_">push</span>({</span><br><span class="line">    <span class="attr">name</span>: <span class="string">'cart'</span></span><br><span class="line">  })</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>a标签跳转</p>
<blockquote>
<p>直接通过a href也可以跳转，但是会刷新页面</p>
</blockquote>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<h3 id="历史记录"><a href="#历史记录" class="headerlink" title="历史记录"></a>历史记录</h3><ul>
<li><p>replace的使用</p>
<blockquote>
<p>采用replace进行页面的跳转同样也会渲染新的Vue组件，但是在history中不会重复保存记录，而是替换原有的vue组件；</p>
</blockquote>
<ul>
<li><p>router-link使用方法</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">replace</span> <span class="attr">to</span>=<span class="string">"/cart"</span>&gt;</span>Cart<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>编程式导航</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用官方的hock</span></span><br><span class="line"><span class="keyword">import</span> { useRouter } <span class="keyword">from</span> <span class="string">'vue-router'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">toPage</span> = (<span class="params">url: <span class="built_in">string</span></span>) =&gt; {</span><br><span class="line">  router.<span class="title function_">replace</span>(url)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
</li>
<li><p>前进-后退</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"next"</span>&gt;</span>前进<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"prev"</span>&gt;</span>后退<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">next</span> = (<span class="params"></span>) =&gt; {</span><br><span class="line">  <span class="comment">//前进 数量不限于1</span></span><br><span class="line">  router.<span class="title function_">go</span>(<span class="number">1</span>)</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="title function_">prev</span> = (<span class="params"></span>) =&gt; {</span><br><span class="line">  <span class="comment">//后退</span></span><br><span class="line">  router.<span class="title function_">back</span>()</span><br><span class="line">  <span class="comment">//router.go(-1)</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<h3 id="路由传参"><a href="#路由传参" class="headerlink" title="路由传参"></a>路由传参</h3><blockquote>
<p>首先是下面代码所用到的数据：</p>
</blockquote>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line">    <span class="attr">"data"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"id"</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"小明"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"age"</span><span class="punctuation">:</span> <span class="number">20</span></span><br><span class="line">        <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"id"</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"小红"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"age"</span><span class="punctuation">:</span> <span class="number">21</span></span><br><span class="line">        <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"id"</span><span class="punctuation">:</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"小黑"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"age"</span><span class="punctuation">:</span> <span class="number">22</span></span><br><span class="line">        <span class="punctuation">}</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p>query路由传参</p>
<blockquote>
<p>编程式路由导航，使用router push 或者 replace的时候，改为对象形式新增query，必须传入一个对象</p>
</blockquote>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=<span class="string">"ts"</span>&gt;</span><br><span class="line"><span class="keyword">import</span> { useRouter } <span class="keyword">from</span> <span class="string">'vue-router'</span>;</span><br><span class="line"><span class="keyword">import</span> { data } <span class="keyword">from</span> <span class="string">'../data/testList.json'</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span><br><span class="line"><span class="keyword">type</span> item = {</span><br><span class="line">    <span class="attr">id</span>: <span class="built_in">number</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">toDetail</span> = (<span class="params">item: item</span>) =&gt; {</span><br><span class="line">    router.<span class="title function_">push</span>({</span><br><span class="line">        <span class="comment">//这里也可以是name</span></span><br><span class="line">        <span class="attr">path</span>: <span class="string">'/detail'</span>,</span><br><span class="line">        <span class="attr">query</span>: item</span><br><span class="line">    })</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p>接收参数，使用useRoute的query</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"router.back()"</span>&gt;</span>返回<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>我是详情页面<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>姓名：{{ route.query.name }}<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>年龄：{{ route.query.age }}<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">"ts"</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> { useRouter, useRoute } <span class="keyword">from</span> <span class="string">'vue-router'</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> route = <span class="title function_">useRoute</span>()</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>此时地址栏：</p>
<ul>
<li><code>http://localhost:3000/detail?id=1&amp;name=小明&amp;age=20</code></li>
</ul>
</li>
</ul>
</li>
<li><p>params路由传参</p>
<blockquote>
<p>编程式导航，使用router.push或者replace的时候改为对象形式，并且只能使用name，path无效，然后传入params</p>
</blockquote>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">toDetail</span> = (<span class="params">item: item</span>) =&gt; {</span><br><span class="line">    router.<span class="title function_">push</span>({</span><br><span class="line">        <span class="attr">name</span>: <span class="string">'detail'</span>,</span><br><span class="line">        <span class="attr">params</span>: item</span><br><span class="line">    })</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p>接收参数，使用useRoute的params</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"router.back()"</span>&gt;</span>返回<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>我是详情页面<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>姓名：{{ route.params.name }}<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>年龄：{{ route.params.age }}<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">"ts"</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> { useRouter, useRoute } <span class="keyword">from</span> <span class="string">'vue-router'</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> route = <span class="title function_">useRoute</span>()</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>此时地址栏：</p>
<ul>
<li><code>http://localhost:3000/detail</code></li>
<li>刷新会丢失数据</li>
</ul>
</li>
</ul>
</li>
<li><p>动态路由传参</p>
<blockquote>
<p>很多时候，我们需要将给定匹配模式的路由映射到同一个组件进行渲染，在Vue Router中，我们可以在路径中使用一个动态字段来实现，我们称之为 路径参数</p>
</blockquote>
<p style="color:red;font-weight:600;">路径参数用冒号 : 表示。当一个路由被匹配时，它的params的值将在每个组件</p>

<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="attr">routes</span>: <span class="title class_">Array</span>&lt;<span class="title class_">RouteRecordRaw</span>&gt; = [</span><br><span class="line">    {</span><br><span class="line">        <span class="attr">path</span>: <span class="string">"/"</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">'../components/Table.vue'</span>)</span><br><span class="line">    },</span><br><span class="line">    {</span><br><span class="line">        <span class="comment">//动态路由参数</span></span><br><span class="line">        <span class="attr">path</span>: <span class="string">"/detail/:id"</span>,</span><br><span class="line">        <span class="attr">name</span>: <span class="string">'detail'</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">'../components/Detail.vue'</span>)</span><br><span class="line">    }</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">"ts"</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> { useRouter } <span class="keyword">from</span> <span class="string">'vue-router'</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> { data } <span class="keyword">from</span> <span class="string">'../data/testList.json'</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span></span><br><span class="line"><span class="language-javascript">type item = {</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">id</span>: number,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: string,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">age</span>: number</span></span><br><span class="line"><span class="language-javascript">}</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">toDetail</span> = (<span class="params">item: item</span>) =&gt; {</span></span><br><span class="line"><span class="language-javascript">    router.<span class="title function_">push</span>({</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">name</span>: <span class="string">'detail'</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">params</span>: {</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//这里对应上动态路由的参数id，地址栏会响应改变</span></span></span><br><span class="line"><span class="language-javascript">            <span class="attr">id</span>: item.<span class="property">id</span></span></span><br><span class="line"><span class="language-javascript">        }</span></span><br><span class="line"><span class="language-javascript">    })</span></span><br><span class="line"><span class="language-javascript">}</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>此时地址栏：<ul>
<li><code>http://localhost:3000/detail/1</code></li>
</ul>
</li>
</ul>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"router.back()"</span>&gt;</span>返回<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>我是详情页面<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>ID：{{ route.params.id }}<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>姓名：{{ person.name }}<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>年龄：{{ person.age }}<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">"ts"</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> { data } <span class="keyword">from</span> <span class="string">'../data/testList.json'</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> { useRouter, useRoute } <span class="keyword">from</span> <span class="string">'vue-router'</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> route = <span class="title function_">useRoute</span>()</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">//数组的find方法会返回找到的对象</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> person = data.<span class="title function_">find</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">id</span> === <span class="title class_">Number</span>(route.<span class="property">params</span>.<span class="property">id</span>))</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<h3 id="命名视图"><a href="#命名视图" class="headerlink" title="命名视图"></a>命名视图</h3><blockquote>
<p>​    命名视图可以在同一级（同一个组件）中展示更多的路由视图，而不是嵌套显示。 命名视图可以让一个组件中具有多个路由渲染出口，这对于一些特定的布局组件非常有用。 命名视图的概念非常类似于“具名插槽”，并且视图的默认名称也是 default。</p>
<p>​    一个视图使用一个组件渲染，因此对于同个路由，多个视图就需要多个组件。确保正确使用 components 配置 (带上 s)</p>
</blockquote>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { createRouter, createWebHistory, <span class="title class_">RouteRecordRaw</span> } <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="attr">routes</span>: <span class="title class_">Array</span>&lt;<span class="title class_">RouteRecordRaw</span>&gt; = [</span><br><span class="line">    {</span><br><span class="line">        <span class="attr">path</span>: <span class="string">"/"</span>,</span><br><span class="line">        <span class="attr">components</span>: {</span><br><span class="line">            <span class="attr">default</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">'../components/layout/menu.vue'</span>),</span><br><span class="line">            <span class="attr">header</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">'../components/layout/header.vue'</span>),</span><br><span class="line">            <span class="attr">content</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">'../components/layout/content.vue'</span>),</span><br><span class="line">        }</span><br><span class="line">    },</span><br><span class="line">]</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>({</span><br><span class="line">    <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(),</span><br><span class="line">    routes</span><br><span class="line">})</span><br><span class="line"> </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></tbody></table></figure>

<p>对应Router-view通过name对应组件</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">   	<span class="tag">&lt;<span class="name">router-view</span> <span class="attr">name</span>=<span class="string">"header"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">router-view</span> <span class="attr">name</span>=<span class="string">"content"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="重定向，别名"><a href="#重定向，别名" class="headerlink" title="重定向，别名"></a>重定向，别名</h3><ul>
<li><p>重定向：redirect</p>
<ul>
<li><p>字符串形式配置，访问 / 重定向到 /user1</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="attr">routes</span>: <span class="title class_">Array</span>&lt;<span class="title class_">RouteRecordRaw</span>&gt; = [</span><br><span class="line">    {</span><br><span class="line">        <span class="attr">path</span>:<span class="string">'/'</span>,</span><br><span class="line">        <span class="attr">component</span>:<span class="function">()=&gt;</span> <span class="title function_">import</span>(<span class="string">'../components/root.vue'</span>),</span><br><span class="line">        <span class="attr">redirect</span>:<span class="string">'/user1'</span>,</span><br><span class="line">        <span class="attr">children</span>:[</span><br><span class="line">            {</span><br><span class="line">                <span class="attr">path</span>:<span class="string">'/user1'</span>,</span><br><span class="line">                <span class="attr">components</span>:{</span><br><span class="line">                    <span class="attr">default</span>:<span class="function">()=&gt;</span> <span class="title function_">import</span>(<span class="string">'../components/A.vue'</span>)</span><br><span class="line">                }</span><br><span class="line">            },</span><br><span class="line">            {</span><br><span class="line">                <span class="attr">path</span>:<span class="string">'/user2'</span>,</span><br><span class="line">                <span class="attr">components</span>:{</span><br><span class="line">                    <span class="attr">bbb</span>:<span class="function">()=&gt;</span> <span class="title function_">import</span>(<span class="string">'../components/B.vue'</span>),</span><br><span class="line">                    <span class="attr">ccc</span>:<span class="function">()=&gt;</span> <span class="title function_">import</span>(<span class="string">'../components/C.vue'</span>)</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        ]</span><br><span class="line">    }</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>对象形式配置</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">redirect</span>: { <span class="attr">path</span>: <span class="string">'/user1'</span> },</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>函数模式（可以传参）</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">redirect</span>: <span class="function">(<span class="params">to</span>) =&gt;</span> {</span><br><span class="line">    <span class="keyword">return</span> {</span><br><span class="line">        <span class="attr">path</span>: <span class="string">'/user1'</span>,</span><br><span class="line">        <span class="attr">query</span>: to.<span class="property">query</span></span><br><span class="line">    }</span><br><span class="line">},</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
</li>
<li><p>别名：alias</p>
<ul>
<li><p>将 / 别名为 /root，意味着当用户访问 /root时，和访问 / 的资源是一样的</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">path</span>: <span class="string">'/'</span>,</span><br><span class="line"><span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">'../components/root.vue'</span>),</span><br><span class="line"><span class="attr">alias</span>:[<span class="string">"/root"</span>,<span class="string">"/root2"</span>,<span class="string">"/root3"</span>],</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
</li>
</ul>
<h3 id="导航守卫"><a href="#导航守卫" class="headerlink" title="导航守卫"></a>导航守卫</h3><ul>
<li><p>全局前置守卫</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">router.beforeEach((to,form,next)=&gt;{</span><br><span class="line">	console.log(to,form);</span><br><span class="line">	next()</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>

<blockquote>
<p>to:   即将要进入的路由对象；<br>from:  当前导航正要离开的路由对象；<br>next(): 进行管道中的下一个钩子。如果全部钩子执行完了，则导航的状态就是 confirmed (确认的)。<br>next(false): 中断当前的导航。如果浏览器的 URL 改变了 (可能是用户手动或者浏览器后退按钮)，那么 URL 地址会重置到 from 路由对应的地址。<br>next(‘/‘) 或者 next({ path: ‘/‘ }): 跳转到一个不同的地址。当前的导航被中断，然后进行一个新的导航。</p>
</blockquote>
<ul>
<li><p>例：权限判断</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> whileList = [<span class="string">'/'</span>]</span><br><span class="line"> </span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> {</span><br><span class="line">    <span class="keyword">let</span> token = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">'token'</span>)</span><br><span class="line">    <span class="comment">//白名单 有值 或者登陆过存储了token信息可以跳转 否则就去登录页面</span></span><br><span class="line">    <span class="keyword">if</span> (whileList.<span class="title function_">includes</span>(to.<span class="property">path</span>) || token) {</span><br><span class="line">        <span class="title function_">next</span>()</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="title function_">next</span>({</span><br><span class="line">            <span class="attr">path</span>:<span class="string">'/'</span></span><br><span class="line">        })</span><br><span class="line">    }</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">柚子</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://youzi2233.github.io/undefined/63422.html">https://youzi2233.github.io/undefined/63422.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://youzi2233.github.io" target="_blank">柚の小屋</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/TypeScript/">TypeScript</a><a class="post-meta__tags" href="/tags/Vue3-0/">Vue3.0</a><a class="post-meta__tags" href="/tags/Pinia/">Pinia</a><a class="post-meta__tags" href="/tags/vite/">vite</a></div><div class="post_share"><div class="social-share" data-image="/imgs/vue3-ts.jpg" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/undefined/40631.html"><img class="prev-cover" src= "/img/loading.gif" data-lazy-src="/imgs/%E9%87%8D%E6%B8%A9%E9%93%BE%E8%A1%A8%E5%AD%A6%E4%B9%A0.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">重温数据结构—链表(TS实现)</div></div></a></div><div class="next-post pull-right"><a href="/undefined/25526.html"><img class="next-cover" src= "/img/loading.gif" data-lazy-src="/imgs/ts%E5%B0%81%E9%9D%A2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">TypeScript学习</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/undefined/25526.html" title="TypeScript学习"><img class="cover" src= "/img/loading.gif" data-lazy-src="/imgs/ts%E5%B0%81%E9%9D%A2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-03</div><div class="title">TypeScript学习</div></div></a></div><div><a href="/undefined/40631.html" title="重温数据结构—链表(TS实现)"><img class="cover" src= "/img/loading.gif" data-lazy-src="/imgs/%E9%87%8D%E6%B8%A9%E9%93%BE%E8%A1%A8%E5%AD%A6%E4%B9%A0.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-16</div><div class="title">重温数据结构—链表(TS实现)</div></div></a></div><div><a href="/undefined/26758.html" title="重温数据结构—树(TS实现)"><img class="cover" src= "/img/loading.gif" data-lazy-src="/imgs/%E9%87%8D%E6%B8%A9%E6%A0%91%E5%AD%A6%E4%B9%A0.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-18</div><div class="title">重温数据结构—树(TS实现)</div></div></a></div><div><a href="/undefined/46905.html" title="Vue3.0学习"><img class="cover" src= "/img/loading.gif" data-lazy-src="/imgs/vue3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-25</div><div class="title">Vue3.0学习</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "/img/loading.gif" data-lazy-src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/loading.gif'" alt="avatar"/></div><div class="author-info__name">柚子</div><div class="author-info__description">活出自己想要的模样！</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">13</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Youzi2233/"><i class="fab iconfont icon-github1"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Youzi2233/" target="_blank" title="Github"><i class="fab iconfont icon-github"></i></a><a class="social-icon" href="tencent://AddContact/?fromId=50&amp;fromSubId=1&amp;subcmd=all&amp;uin=1348502923" target="_blank" title="QQ"><i class="fas iconfont icon-qq"></i></a><a class="social-icon" href="mailto:1348502923@qq.com" target="_blank" title="Email"><i class="fas iconfont icon-a-13-Email"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="iconfont icon-rocket__easyi"></i><span>简介</span></div><div class="announcement_content">在校大学生一枚<br>喜欢动漫、音乐、二次元<br>有事可以点击上面QQ标识联系</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%90%E7%88%B6%E7%BB%84%E4%BB%B6%E4%BC%A0%E5%8F%82"><span class="toc-number">1.</span> <span class="toc-text">子父组件传参</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8C%E9%97%AE%E5%8F%B7%E8%AF%AD%E6%B3%95"><span class="toc-number">2.</span> <span class="toc-text">双问号语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TypeScript%E9%AB%98%E7%BA%A7%E6%8A%80%E5%B7%A7%EF%BC%88Pick%EF%BC%8CPartial%E7%AD%89%EF%BC%89"><span class="toc-number">3.</span> <span class="toc-text">TypeScript高级技巧（Pick，Partial等）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-keyof%E5%92%8Cin"><span class="toc-number">3.1.</span> <span class="toc-text">1. keyof和in</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Partial%E5%92%8CPick"><span class="toc-number">3.2.</span> <span class="toc-text">Partial和Pick</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E7%BB%84%E4%BB%B6"><span class="toc-number">4.</span> <span class="toc-text">动态组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Transition%E7%BB%84%E4%BB%B6"><span class="toc-number">5.</span> <span class="toc-text">Transition组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Transition%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">5.1.</span> <span class="toc-text">Transition生命周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Transition-group%E8%BF%87%E6%B8%A1%E5%88%97%E8%A1%A8"><span class="toc-number">5.2.</span> <span class="toc-text">Transition-group过渡列表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%BC%95%E5%85%A5%E6%8F%92%E4%BB%B6"><span class="toc-number">6.</span> <span class="toc-text">自动引入插件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TSX"><span class="toc-number">7.</span> <span class="toc-text">TSX</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pinia"><span class="toc-number">8.</span> <span class="toc-text">Pinia</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E4%BB%93%E5%BA%93Store"><span class="toc-number">8.1.</span> <span class="toc-text">初始化仓库Store</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#State%E7%9A%84%E4%BF%AE%E6%94%B9"><span class="toc-number">8.2.</span> <span class="toc-text">State的修改</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%9E%84Store"><span class="toc-number">8.3.</span> <span class="toc-text">解构Store</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#actions%EF%BC%8Cgetters"><span class="toc-number">8.4.</span> <span class="toc-text">actions，getters</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#API"><span class="toc-number">8.5.</span> <span class="toc-text">API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pinia%E6%8C%81%E4%B9%85%E5%8C%96%E6%8F%92%E4%BB%B6"><span class="toc-number">8.6.</span> <span class="toc-text">pinia持久化插件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue-Router4"><span class="toc-number">9.</span> <span class="toc-text">Vue-Router4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A5%E9%97%A8"><span class="toc-number">9.1.</span> <span class="toc-text">入门</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E7%A8%8B%E5%BC%8F%E5%AF%BC%E8%88%AA"><span class="toc-number">9.2.</span> <span class="toc-text">编程式导航</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95"><span class="toc-number">9.3.</span> <span class="toc-text">历史记录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E4%BC%A0%E5%8F%82"><span class="toc-number">9.4.</span> <span class="toc-text">路由传参</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E5%90%8D%E8%A7%86%E5%9B%BE"><span class="toc-number">9.5.</span> <span class="toc-text">命名视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E5%AE%9A%E5%90%91%EF%BC%8C%E5%88%AB%E5%90%8D"><span class="toc-number">9.6.</span> <span class="toc-text">重定向，别名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E8%88%AA%E5%AE%88%E5%8D%AB"><span class="toc-number">9.7.</span> <span class="toc-text">导航守卫</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/undefined/23574.html" title="前端面试题总结（持续更新）"><img src= "/img/loading.gif" data-lazy-src="/imgs/yuan.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="前端面试题总结（持续更新）"/></a><div class="content"><a class="title" href="/undefined/23574.html" title="前端面试题总结（持续更新）">前端面试题总结（持续更新）</a><time datetime="2022-11-03T09:20:32.620Z" title="发表于 2022-11-03 17:20:32">2022-11-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/undefined/26758.html" title="重温数据结构—树(TS实现)"><img src= "/img/loading.gif" data-lazy-src="/imgs/%E9%87%8D%E6%B8%A9%E6%A0%91%E5%AD%A6%E4%B9%A0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="重温数据结构—树(TS实现)"/></a><div class="content"><a class="title" href="/undefined/26758.html" title="重温数据结构—树(TS实现)">重温数据结构—树(TS实现)</a><time datetime="2022-08-17T20:22:21.377Z" title="发表于 2022-08-18 04:22:21">2022-08-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/undefined/40631.html" title="重温数据结构—链表(TS实现)"><img src= "/img/loading.gif" data-lazy-src="/imgs/%E9%87%8D%E6%B8%A9%E9%93%BE%E8%A1%A8%E5%AD%A6%E4%B9%A0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="重温数据结构—链表(TS实现)"/></a><div class="content"><a class="title" href="/undefined/40631.html" title="重温数据结构—链表(TS实现)">重温数据结构—链表(TS实现)</a><time datetime="2022-08-16T10:28:10.000Z" title="发表于 2022-08-16 18:28:10">2022-08-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/undefined/63422.html" title="Vue3+TypeScript补充与拓展"><img src= "/img/loading.gif" data-lazy-src="/imgs/vue3-ts.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Vue3+TypeScript补充与拓展"/></a><div class="content"><a class="title" href="/undefined/63422.html" title="Vue3+TypeScript补充与拓展">Vue3+TypeScript补充与拓展</a><time datetime="2022-04-13T06:20:10.000Z" title="发表于 2022-04-13 14:20:10">2022-04-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/undefined/25526.html" title="TypeScript学习"><img src= "/img/loading.gif" data-lazy-src="/imgs/ts%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="TypeScript学习"/></a><div class="content"><a class="title" href="/undefined/25526.html" title="TypeScript学习">TypeScript学习</a><time datetime="2022-04-03T04:10:04.000Z" title="发表于 2022-04-03 12:10:04">2022-04-03</time></div></div></div></div></div></div></main><footer id="footer" style="background-color: transparent;"><div id="footer-wrap"><div class="copyright">&copy;2022 &nbsp;&nbsp;<i style="color:#FF6A6A;animation: announ_animation 0.8s linear infinite;"class="fas fa-heart"></i> &nbsp;&nbsp;By  柚子</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadWaline () {
  function initWaline () {
    const waline = new Waline(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://waline-hexo-kbah2mjbi-www1348502923-qqcom.vercel.app/',
      path: location.pathname,
      visitor: false,
      dark: 'html[data-theme="dark"]'
    }, {"emoji":["https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/bilibili","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/qq"],"placeholder":"(建议使用QQ邮箱，评论头像采用QQ头像，网址选填)"}))
  }

  if (typeof Waline === 'function') initWaline()
  else getScript('https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js').then(initWaline)
}

if ('Waline' === 'Waline' || !true) {
  if (true) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
  else setTimeout(loadWaline, 0)
} else {
  function loadOtherComment () {
    loadWaline()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>